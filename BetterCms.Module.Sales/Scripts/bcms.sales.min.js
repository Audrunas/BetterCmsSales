bettercms.define("bcms.sales",["bcms.jquery","bcms","bcms.siteSettings","bcms.dynamicContent","bcms.ko.extenders","bcms.ko.grid"],function(a,b,u,c,j,k){var s={},t={},l={loadSiteSettingsProductsUrl:null,loadProductsUrl:null,saveProductUrl:null,deleteProductUrl:null,loadSiteSettingsUnitsUrl:null,loadUnitsUrl:null,saveUnitUrl:null,deleteUnitUrl:null,loadSiteSettingsBuyersUrl:null,saveBuyerUrl:null,deleteBuyerUrl:null,loadBuyersUrl:null,loadSiteSettingsSuppliersUrl:null,saveSupplierUrl:null,deleteSupplierUrl:null,loadSuppliersUrl:null,loadSiteSettingsPurchasesUrl:null,},d={deleteProductDialogTitle:null,deleteUnitDialogTitle:null,deleteBuyerDialogTitle:null,deleteSupplierDialogTitle:null,deletePurchaseDialogTitle:null,buyersTabTitle:null,suppliersTabTitle:null};s.links=l;s.globalization=d;s.selectors=t;var o=(function(x){b.extendsClass(y,x);function y(z,C,A,E){x.call(this,z,l.loadProductsUrl,C,A);var D=this;D.units=[];if(E&&a.isArray(E)){for(var B=0;B<E.length;B++){D.units.push({id:E[B].Id,name:E[B].Title});}}}y.prototype.createItem=function(z){var A=new p(this,z);if(this.units&&this.units.length>0&&!z.Unit&&!z.UnitName){A.unit(this.units[0].id);A.unitName(this.units[0].name);}return A;};return y;})(k.ListViewModel);var p=(function(x){b.extendsClass(y,x);function y(A,z){x.call(this,A,z);var B=this;B.name=j.observable().extend({required:"",maxLength:{maxLength:j.maxLength.name}});B.unit=j.observable();B.unitName=j.observable();B.registerFields(B.name,B.unit);B.name(z.Name);B.unit(z.Unit);B.unitName(z.UnitName);}y.prototype.getDeleteConfirmationMessage=function(){return a.format(d.deleteProductDialogTitle,this.name());};y.prototype.getSaveParams=function(){var z=x.prototype.getSaveParams.call(this);z.Name=this.name();z.Unit=this.unit();return z;};return y;})(k.ItemViewModel);function f(A){var x=u.getMainContainer(),y=(A.Success==true)?A.Data:{};var B=new o(x,y.Items,y.GridOptions,y.Units);B.deleteUrl=l.deleteProductUrl;B.saveUrl=l.saveProductUrl;j.applyBindings(B,x.get(0));var z=x.find("input[type=text],textarea,select").filter(":visible:first");if(z){z.focus();}}s.loadSiteSettingsSalesProducts=function(){c.bindSiteSettings(u,l.loadSiteSettingsProductsUrl,{contentAvailable:f});};var v=(function(x){b.extendsClass(y,x);function y(z,B,A){x.call(this,z,l.loadUnitsUrl,B,A);}y.prototype.createItem=function(z){var A=new w(this,z);return A;};return y;})(k.ListViewModel);var w=(function(x){b.extendsClass(y,x);function y(A,z){x.call(this,A,z);var B=this;B.title=j.observable().extend({required:"",maxLength:{maxLength:j.maxLength.name}});B.shortTitle=j.observable().extend({required:"",maxLength:{maxLength:j.maxLength.name}});B.registerFields(B.title,B.shortTitle);B.title(z.Title);B.shortTitle(z.ShortTitle);}y.prototype.getDeleteConfirmationMessage=function(){return a.format(d.deleteUnitDialogTitle,this.title());};y.prototype.getSaveParams=function(){var z=x.prototype.getSaveParams.call(this);z.Title=this.title();z.ShortTitle=this.shortTitle();return z;};return y;})(k.ItemViewModel);function i(A){var x=u.getMainContainer(),y=(A.Success==true)?A.Data:{};var B=new v(x,y.Items,y.GridOptions);B.deleteUrl=l.deleteUnitUrl;B.saveUrl=l.saveUnitUrl;j.applyBindings(B,x.get(0));var z=x.find("input[type=text],textarea,select").filter(":visible:first");if(z){z.focus();}}s.loadSiteSettingsSalesUnits=function(){c.bindSiteSettings(u,l.loadSiteSettingsUnitsUrl,{contentAvailable:i});};var m=(function(x){b.extendsClass(y,x);function y(z,C,B,D,A){x.call(this,z,D,C,B);this.deleteConfirmationMessage=A;}y.prototype.createItem=function(z){var A=new n(this,z);return A;};return y;})(k.ListViewModel);var n=(function(x){b.extendsClass(y,x);function y(A,z){x.call(this,A,z);var B=this;B.name=j.observable().extend({required:"",maxLength:{maxLength:j.maxLength.name}});B.email=j.observable().extend({email:"",maxLength:{maxLength:j.maxLength.email}});B.phoneNumber=j.observable().extend({maxLength:{maxLength:j.maxLength.name}});B.registerFields(B.name,B.email,B.phoneNumber);B.name(z.Name);B.email(z.Email);B.phoneNumber(z.PhoneNumber);}y.prototype.getDeleteConfirmationMessage=function(){return a.format(this.parent.deleteConfirmationMessage,this.name());};y.prototype.getSaveParams=function(){var z=x.prototype.getSaveParams.call(this);z.Name=this.name();z.Email=this.email();z.PhoneNumber=this.phoneNumber();return z;};return y;})(k.ItemViewModel);function e(x,A){var y=(A.Success==true)?A.Data:{};var B=new m(x,y.Items,y.GridOptions,l.loadBuyersUrl,d.deleteBuyerDialogTitle);B.deleteUrl=l.deleteBuyerUrl;B.saveUrl=l.saveBuyerUrl;j.applyBindings(B,x.get(0));var z=x.find("input[type=text],textarea,select").filter(":visible:first");if(z){z.focus();}}function h(x,A){var y=(A.Success==true)?A.Data:{};var B=new m(x,y.Items,y.GridOptions,l.loadSuppliersUrl,d.deleteSupplierDialogTitle);B.deleteUrl=l.deleteSupplierUrl;B.saveUrl=l.saveSupplierUrl;j.applyBindings(B,x.get(0));var z=x.find("input[type=text],textarea,select").filter(":visible:first");if(z){z.focus();}}s.loadSiteSettingsSalesPartners=function(){var A=[],y=function(B){var C=B.find("input[type=text],textarea,select").filter(":visible:first");if(C){C.focus();}};var x=new u.TabViewModel(d.buyersTabTitle,l.loadSiteSettingsBuyersUrl,e,y);A.push(x);var z=new u.TabViewModel(d.suppliersTabTitle,l.loadSiteSettingsSuppliersUrl,h,y);A.push(z);u.initContentTabs(A);};var q=(function(x){b.extendsClass(y,x);function y(z,B,A,C){x.call(this,z,l.loadPurchasesUrl,B,A);}y.prototype.createItem=function(z){var A=new r(this,z);return A;};return y;})(k.ListViewModel);var r=(function(x){b.extendsClass(y,x);function y(A,z){x.call(this,A,z);var B=this;B.name=j.observable().extend({required:"",maxLength:{maxLength:j.maxLength.name}});B.unit=j.observable();B.unitName=j.observable();B.registerFields(B.name,B.unit);B.name(z.Name);B.unit(z.Unit);B.unitName(z.UnitName);}y.prototype.getDeleteConfirmationMessage=function(){return a.format(d.deletePurchaseDialogTitle,this.name());};return y;})(k.ItemViewModel);function g(A){var x=u.getMainContainer(),y=(A.Success==true)?A.Data:{};var B=new q(x,y.Items,y.GridOptions);j.applyBindings(B,x.get(0));var z=x.find("input[type=text],textarea,select").filter(":visible:first");if(z){z.focus();}}s.loadSiteSettingsPurchases=function(){c.bindSiteSettings(u,l.loadSiteSettingsPurchasesUrl,{contentAvailable:g});};s.init=function(){b.logger.debug("Initializing bcms.sales module.");};b.registerInit(s.init);return s;});